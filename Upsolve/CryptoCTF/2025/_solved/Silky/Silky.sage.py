

# This file was *autogenerated* from the file Silky.sage
from sage.all_cmdline import *   # import sage library

_sage_const_1 = Integer(1); _sage_const_5 = Integer(5); _sage_const_19 = Integer(19); _sage_const_110 = Integer(110); _sage_const_128 = Integer(128); _sage_const_4 = Integer(4); _sage_const_0 = Integer(0); _sage_const_12 = Integer(12); _sage_const_2 = Integer(2); _sage_const_16 = Integer(16)#!/usr/bin/env sage

import sys
from Crypto.Util.number import *
from flag import flag

def die(*args):
	pr(*args)
	quit()
	
def pr(*args):
	s = " ".join(map(str, args))
	sys.stdout.write(s + "\n")
	sys.stdout.flush()
	
def sc():
	return sys.stdin.buffer.readline()

def randroad(B):
	return vector(ZZ,[randint(-B, B) for _ in range(n)])

def roadband():
	return randroad(B * (D + _sage_const_1 ))

def silky(key):
	while True:
		R = roadband()
		_R = R - key
		if min(_R) >= - B * D and max(_R) <= B * D:
			return R

def main():
	border = "┃"
	pr(        "┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓")
	pr(border, ".:::      Welcome to the Silky cryptography oracle task!     :::.", border)
	pr(border, "Your mission is to find flag by analyzing this weird oracle! :-) ", border)
	pr(        "┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛")
	global flag, B, n, D, t
	B, n = _sage_const_5 , _sage_const_19 
	D, t = _sage_const_110 , _sage_const_128 
	l = int(_sage_const_4  * D * B / t)
	c, key = _sage_const_0 , randroad(B)
	while True:
		c += _sage_const_1 
		if c >= _sage_const_12 :
			die(border, "My brain is fried, quitting...")
		pr(f"{border} Options: \n{border}\t[G]et flag! \n{border}\t[M]ake Silky! \n{border}\t[Q]uit")
		ans = sc().decode().strip().lower()
		if ans == 'm':
			R = [silky(key) for _ in range(int(l * t // _sage_const_2 ))]
			for i in range(len(R) // _sage_const_16 ):
				pr(border, f"{str(R[_sage_const_16  * i:_sage_const_16  * (i + _sage_const_1 )]).replace(',', '')}")
		elif ans == 'g':
			pr(border, f'Please submit the secret key: ')
			inp = sc().decode().strip()
			try:
				_key = vector(ZZ, [int(_) for _ in inp.split(',')])
			except:
				die(border, f'The input you provided is not valid! Bye!!')
			if _key == key:
				die(border, f'Congrats! You got the flag: {flag}')
			else:
				die(border, f'Your key is incorrect!')
		elif ans == 'q':
			die(border, "Quitting...")
		else:
			die(border, "Bye...")

if __name__ == '__main__':
	main()

