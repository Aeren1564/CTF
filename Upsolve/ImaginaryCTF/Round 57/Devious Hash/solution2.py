from CTF_Library import *

p = 6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151
assert p == 2**521 - 1
F = GF(p)

output = 5529146955026504451007428379478468505767752969729288045439800587429289159437142456530335848325725612485348038928038452092595039114633083434109252927938183950

x = GF(p)['X'].gen()

for mask in reversed(range(2**8)):
	print(f"{mask = }")
	f = 0
	for i in range(8):
		f += x
		if mask >> i & 1:
			f -= 2**521
		f *= f
	f -= output
	for r, _ in f.roots():
		if r in F:
			flag = long_to_bytes(int(r))
			print(flag)
			if b"ictf{" in flag:
				exit(0)
